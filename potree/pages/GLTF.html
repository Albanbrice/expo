<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Potree Viewer</title>

	<link rel="stylesheet" type="text/css" href="../build/potree/potree.css">
	<link rel="stylesheet" type="text/css" href="../libs/jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="../libs/perfect-scrollbar/css/perfect-scrollbar.css">
	<link rel="stylesheet" type="text/css" href="../libs/openlayers3/ol.css">
	<link rel="stylesheet" type="text/css" href="../libs/spectrum/spectrum.css">
	<link rel="stylesheet" type="text/css" href="../libs/jstree/themes/mixed/style.css">
</head>

<body>
	<script src="../libs/jquery/jquery-3.1.1.min.js"></script>
	<script src="../libs/spectrum/spectrum.js"></script>
	<script src="../libs/perfect-scrollbar/js/perfect-scrollbar.jquery.js"></script>
	<script src="../libs/jquery-ui/jquery-ui.min.js"></script>
	<script src="../libs/three.js/build/three.min.js"></script>
	<script src="../libs/other/BinaryHeap.js"></script>
	<script src="../libs/tween/tween.min.js"></script>
	<script src="../libs/d3/d3.js"></script>
	<script src="../libs/proj4/proj4.js"></script>
	<script src="../libs/openlayers3/ol.js"></script>
	<script src="../libs/i18next/i18next.js"></script>
	<script src="../libs/jstree/jstree.js"></script>
	<script src="../build/potree/potree.js"></script>
	<script src="../libs/plasio/js/laslaz.js"></script>
	<script src="../libs/other/PLYLoader.js"></script>
	<script src="../libs/other/OBJLoader.js"></script>
	<script src="../libs/other/GLTFLoader.js"></script>
	
	<!-- INCLUDE ADDITIONAL DEPENDENCIES HERE -->
	<!-- INCLUDE SETTINGS HERE -->
	
	<div class="potree_container" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; ">
		<div id="potree_render_area"></div>
		<div id="potree_sidebar_container"> </div>
	</div>
	
	<script>
	
		window.viewer = new Potree.Viewer(document.getElementById("potree_render_area"));
		
		viewer.setEDLEnabled(false);
		viewer.setFOV(50);
		viewer.setPointBudget(1*1000*1000);
		viewer.loadSettingsFromURL();
		
		viewer.setDescription("");
		
		viewer.loadGUI(() => {
			viewer.setLanguage('en');
			$("#menu_tools").next().show();
			$("#menu_scene").next().show();
			//viewer.toggleSidebar();
		});
		
		// Nuages
		Potree.loadPointCloud("../pointclouds/villa/cloud.js", "villa", function(e){
			let scene = viewer.scene;
			scene.addPointCloud(e.pointcloud);
			
			let material = e.pointcloud.material;
			material.size = 1;
			material.pointSizeType = Potree.PointSizeType.ADAPTIVE;

			scene.view.position.set(30.945, 22.270, 28.767);
			scene.view.lookAt(new THREE.Vector3(22.582, 18.135, 29.369));
			//viewer.fitToScreen();
        });

        // PLY
        var loader = new THREE.PLYLoader();
		loader.load("../models/entree.ply", (geometry) => {
			geometry.computeVertexNormals();
			
			// place three instances of this bunny into the scene
			
			let mesh1;
			{
				let wireframeMaterial = new THREE.MeshBasicMaterial({color:0xf0a732, wireframe:true, transparent:true});
                let material =new THREE.MeshToonMaterial( {color: 0xCCCCCC, transparent:0.5});
				
                mesh1 = new THREE.Mesh( geometry, material );
                wireframe = new THREE.Mesh( geometry, wireframeMaterial );
                mesh1.add(wireframe);

               	//mesh1.position.set(0, 0,0);
				//mesh1.scale.multiplyScalar(500);
				//mesh1.rotation.set(Math.PI / 2, Math.PI, 0)
				viewer.scene.scene.add(mesh1);                
			}   

        
        });
        renderer = new THREE.WebGLRenderer( { antialias: true } );
        
        
        
        
        
        // Modèles 3D

		// {
		// 	let manager = new THREE.LoadingManager();
		// 	manager.onProgress = function ( item, loaded, total ) {
		// 		console.log( item, loaded, total );
		// 	};

            
        //     let onProgress = function ( xhr ) {
		// 		if ( xhr.lengthComputable ) {
		// 			let percentComplete = xhr.loaded / xhr.total * 100;
		// 			console.log( Math.round(percentComplete, 2) + '% downloaded' );
		// 		}
		// 	};

		// 	let onError = function ( xhr ) {};
		// 	let loader = new THREE.OBJLoader( manager );
        //     loader.load(`../models/entree.obj`, function ( object ){ 

        //       let material = new THREE.MeshBasicMaterial( { 
        //         color: 0xffaa00,
        //         wireframe: true
        //      } );

        //         //mesh1 =  new THREE.Mesh(object, material);
        //         //mesh1.position.set(0, 0, 0);
		// 		//mesh1.scale.multiplyScalar(1);
        //         //object.rotation.set(Math.PI / 2, Math.PI, 0)
                
                
        //         viewer.scene.scene.add(object);
        //        	// viewer.onGUILoaded(() => {
		// 		// 	// Add entries to object list in sidebar
		// 		// 	let tree = $(`#jstree_scene`);
		// 		// 	let parentNode = "other";

		// 		// 	let bunnyID = tree.jstree('create_node', parentNode, { 
		// 		// 			text: "entrée", 
		// 		// 			icon: `${Potree.resourcePath}/icons/triangle.svg`,
		// 		// 			data: geometry
		// 		// 		}, 
		// 		// 		"last", false, false);
		// 		// 	tree.jstree(geometry.visible ? "check_node" : "uncheck_node", bunnyID);

		// 		// 	//tree.jstree("open_node", parentNode);
		// 		// });

		// 	}, onProgress, onError );
		// }

	</script>
	
	
  </body>
</html>
